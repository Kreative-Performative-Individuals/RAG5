<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            color: #333;
        }
        header, main {
            max-width: 800px;
            margin: auto;
            padding: 20px;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        header h1 {
            font-size: 2em;
            margin-bottom: 0.5em;
        }
        header p {
            margin: 0;
            color: #555;
        }
        h2 {
            border-bottom: 2px solid #333;
            padding-bottom: 5px;
            margin-top: 1.5em;
        }
        ul {
            list-style: square;
            margin: 10px 0;
            padding-left: 20px;
        }
        code, pre {
            background: #f4f4f4;
            padding: 5px;
            border: 1px solid #ddd;
            font-family: Consolas, monospace;
        }
        pre {
            overflow-x: auto;
            padding: 10px;
        }
        a {
            color: #0066cc;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header>
        <h1>API Documentation - Topic 5</h1>
        <p>Version: 0.1 | Last Updated: 08/12/2024</p>
        <p>Authors: Alice Nicoletta, Marco Dell'Acqua, Nazifa Mosharrat
    </header>
    <main>
        <h2>Introduction</h2>
        <p>
           This documentation aims to fully describe the classes and methods implemented for the functionalities 
           of the RAG model and its interactions with the Knowledge Base and KPI engine.
           The full code can be consulted on the relative GitHub <a href="https://github.com/Kreative-Performative-Individuals/RAG5">repository</a>. 
           
            The main files of our repository are the following:
            <ul>
                <li><kbd>RAG.py</kbd>: contains the RAG class and its methods</li>
                <li><kbd>StructuredOutput.py</kbd>: </li>
                 <li><kbd>function_api.py</kbd>:   </li>
                <li><kbd>main.py</kbd>:   </li>
            </ul>
        </p>

        <h2>RAG.py</h2>
        
            
        <li><code>class Rag()</code> <br>
        Retrieval-Augmented Generation (RAG) model class. <br>
        <ul>    
            <li>Attributes:
            <ul>
                <li>model
                <li>
                <li>    
            </ul>
            <li>Methods:
            <ul>    
                <li><kbd>classify_query(query)</kbd>: given a query, returns its class among KPI calculation, e-mail or reports
                or else.</li>
                <li><kbd>routing</kbd>: Returns a callable chain depending on the result of the classify_query method</li>
                <li><kbd>get_model</kbd>: returns the model. </li>
                <li><kbd>explain_reasoning(dest:str=None, object:BaseModel=None)</kbd> returns a brief description of what 
                the model interpreted the query as. </li>
                <li><kbd>compute_query(obj)</kbd>: if obj is an instance of the class KPIRequest, it returns the KPI engine result
                of the related query and a string of useful informations for the RAG. </li>
                <li><kbd>direct_query(obj, docs, result, query, previous_answer)</kbd> generates the final response for the user, 
                based on some history and what has been computed for the query. </li>
            </ul>
        </ul>
        
        <h2>StructuredOutput.py</h2>
        
        KPIRequest class. Used to generate a request to the KPI engine, based on the user query,
        through langchain_ollama.with_structured_output() method. <br>
        <ul>
            <li>Attributes:</li>
            <ul>
                <li>name: str </li>
                <li>machines: Optional[List[str]] </li>
                <li>time_aggregation: Literal["mean","min","max","var","std","sum"] </li>
                <li>start_date: Optional[str] </li>
                <li>end_date: Optional[str]</li>
                <li>step: Optional[int]</li>
            </ul>
            <li>Methods:</li>
            <ul>
                <li>to_json</li>
                <li> explain_rag: returns a string that explains the KPI request inferred by the model. </li>
            </ul>
        
        </ul>
 </body>
        